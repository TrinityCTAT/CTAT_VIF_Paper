# split multi to single fasta
~/GITHUB/HAASUTIL/multi_to_single_fasta.pl HPV_subset.fasta

# sim insertions and fastqs
for file in HPV*; do  ~/GITHUB/CTAT_VIF/VirusInsertionBenchmarking/util/simulate_virus_insertions.py  --virus_db $file --genome_lib_dir /home/bhaas/CTAT_GENOME_LIBS/GRCh38_gencode_v22_CTAT_lib_Mar012021.plug-n-play/ctat_genome_lib_build_dir --ins_per_virus 50 --out_prefix $file  --sim_read_length 70 ; done

# get truth sets
for file in HPV*.fai; do ~/GITHUB/CTAT_VIF/VirusInsertionBenchmarking/util/make_truth_list.py ${file%%.*} >  ${file%%.*}.insertion_truth_set.tsv; done

# change filename extensions for reads:
for file in *.left_fq; do mv $file ${file%.*}_1.fq ; done
for file in *.right_fq; do mv $file ${file%.*}_2.fq ; done

gzip *fq


## for replicates:

for file in HPV*; do  ~/GITHUB/CTAT_VIF/VirusInsertionBenchmarking/util/simulate_virus_insertions.py  --virus_db $file --genome_lib_dir $CTAT_GENOME_LIB --ins_per_virus 50 --out_prefix $file  --sim_read_length 70 ; done

for file in rep*HPV*.fai; do ~/GITHUB/CTAT_VIF/VirusInsertionBenchmarking/util/make_truth_list.py ${file%%.*} >  ${file%%.*}.insertion_truth_set.tsv; done

for file in *.fq.gz; do gsutil cp $file gs://fc-f5038732-f718-4441-8312-23d4e01e0882/DATA/hpvRepSimsDec272022/$file; done


