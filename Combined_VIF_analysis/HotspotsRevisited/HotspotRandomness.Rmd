---
title: "HotspotRandomStats"
author: "bhaas"
date: '2023-03-29'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```


```{r}


# define_insertion_hotspots.py --insertions_tsv all_insertions_and_virus_content_merged.FILTERED.tsv.distilled.1e+07 --window_size 400000 --output outdir/9555.test --randomize
# was run 10k times to generate the null distribution.

data = read.table(gzfile("data/rand_cluster_size_counts.tsv.gz"), header=F, sep="\t")

colnames(data) = c('trial', 'hotspot_size', 'num_hotspots')

data = data %>% filter(hotspot_size > 1)
```

```{r}

data %>% ggplot(aes(x=as.factor(hotspot_size), y=num_hotspots)) + geom_boxplot() +
  ggtitle("distribution of counts of hotspot sizes")

```


```{r}

# determine probability of seeing at least one hotspot of corresponding size

NUM_ITERS = 10000

frac_info  = data %>% select(trial, hotspot_size) %>% unique() %>%
  group_by(hotspot_size) %>% tally() %>% mutate(p=n/NUM_ITERS)

frac_info

```

So, having a hotspot with 8 samples is expected to occur at 0.014 probabily by random chance.


